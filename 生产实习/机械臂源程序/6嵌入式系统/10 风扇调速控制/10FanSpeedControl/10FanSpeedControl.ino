#include <Arduino.h>
#include <U8g2lib.h>
#ifdef U8X8_HAVE_HW_SPI
#include <SPI.h>
#endif
#ifdef U8X8_HAVE_HW_I2C
#include <Wire.h>
#endif
//选择1.3寸SH1106 OLED显示屏
U8G2_SH1106_128X64_NONAME_F_HW_I2C u8g2(U8G2_R0, /* reset=*/ U8X8_PIN_NONE); 
const unsigned char cz2[] U8X8_PROGMEM = {
  /*--  调入了一幅图像：C:\Users\ADMIN\Desktop\调速风扇.bmp  --*/
  /*--  宽度x高度=56x16  --*/
  0x02, 0x00, 0x40, 0xE0, 0x7F, 0x00, 0x01, 0xE4, 0x9F, 0x40, 0x20, 0x40, 0x00, 0x02, 0x24, 0x11,
  0xFD, 0x27, 0x50, 0xF0, 0x7F, 0x20, 0x11, 0x41, 0xA0, 0x50, 0x10, 0x40, 0xA7, 0x17, 0xF8, 0x23,
  0x49, 0xF0, 0x7F, 0x24, 0x11, 0x48, 0x22, 0x4A, 0x10, 0x00, 0xE4, 0xDF, 0x49, 0x22, 0x44, 0xD0,
  0x7B, 0x24, 0x10, 0xF9, 0x23, 0x44, 0x10, 0x42, 0xA4, 0x17, 0xE1, 0x20, 0x4A, 0x90, 0x52, 0xB4,
  0x14, 0x51, 0x21, 0x4A, 0x10, 0x63, 0xAC, 0x14, 0x49, 0x22, 0x51, 0x91, 0x52, 0xA4, 0x17, 0x45,
  0xA4, 0x50, 0x49, 0x4A, 0x20, 0x90, 0x42, 0x20, 0x80, 0x09, 0x42, 0x10, 0x5C, 0xFC, 0x17, 0x00,
  0x85, 0x31, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
};
int vai = 0;
int FAN = 10;//定义风扇控制引脚为IO号引脚（A6）
void setup() {
  u8g2.begin();//构造u8g2模式：初始化显示器，重置清屏，唤醒屏幕
  pinMode(FAN, OUTPUT);//设置风扇控制引脚为输出引脚
}
void loop() {
  int val;
  val = analogRead(6); //从A6(10号引脚)读取电位器的模拟值
  Serial.println(val, DEC); //通过串口监视器显示电位器读数
  delay(100);
  vai = val / 4;
  if (vai < 0)
    vai = 0;
  analogWrite(FAN, vai);//发送PWM占空比
  u8g2.clearBuffer();          // 清显示屏缓冲区
  u8g2.setFont(u8g2_font_7Segments_26x42_mn); // 设置字体
  u8g2.drawXBMP(0, 0, 56, 16, cz2);//绘制风扇调速控制图标
  u8g2.setCursor(30, 64);
  u8g2.print(vai);//显示占空比
  u8g2.sendBuffer();          //发送缓冲区数据到显示器，发送刷新消息
}
